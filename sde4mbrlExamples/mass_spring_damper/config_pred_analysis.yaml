###################################################################################################################
####################################### Plotting and other configuration  #########################################
###################################################################################################################
# JAX_PLATFORM_NAME=cpu python pred_analysis_script.py --fun unc
# 

# Range used for the mesh plot
qrange: [-0.25, 0.25]
qdotrange: [-0.25, 0.25]

# Number of grids on the axes
num_grid_q: 50
num_grid_qdot: 50

# Number of particles when computing uncertainties
num_particles_std: 50
horizon_pred_accuracy: 20
horizon_uncertainty: 5 # If not specified, it uses horizon_pred_accuracy

# If the observation to state is nondeterministic, 
# this is used for density computation
num_particles_diffusion: 1

training_dataset_config:
  label : 'Dataset'
  color : 'lavender'
  marker: 'x'
  markersize : 8 
  alpha : 1.0
  linestyle : 'None'
  zorder : 100

# Seed for operation
seed: 10

# Mesh configuration
mesh_args:
  cmap: viridis
  shading: gouraud

colorbar_args:
  shrink: 0.95
  # extend: both
  pad: 0.01

extra_args:
  title_right_args:
    rotation: -90
    size: large
    labelpad: 15

# colors = ["black", "#E69F00", "#E69F00", "#56B4E9", "#56B4E9", "#D55E00", "#CC79A7", "#F0E442"]
general_style:
  linewidth: 2.0

curve_plot_style:
  groundtruth:
    label: "Groundtruth"
    color: "black"
    zorder: 100
  nesde:
    label: "Blackbox Neural SDE"
    color: "#E69F00"
    zorder: 30
  node:
    label: "Blackbox Neural ODE"
    color: "#56B4E9"
    zorder: 20
  gaussian:
    label: "Gaussian MLP Ensemble"
    color: "#D55E00"
    zorder: 30
  dataset:
    label : 'Dataset'
    color : 'lavender'
    marker: 'x'
    markersize : 8 
    alpha : 0.3
    linestyle : 'None'
    zorder : 10

############################# Density mesh plots #########################################
##########################################################################################

# # Format for learned models to plot XX__MSD_XX_XX_XX
# # For example nesde__MSD_MeasLow_TopRight_5 according to the name of the learned models
# files2plot: 'nesde__MSD_MeasXX_XX_XX'

# # The list of models to plot in the configuration (usually a grid) they need to be plotted
# fig_args:
#   figsize: [14, 8]
#   nrows: 2
#   ncols: 3
#   sharex: True
#   sharey: True
#   constrained_layout: True

# plot_configs:
#   - value: ['Low', 'TopRight', '5']
#     title: 'Low Meas Noise'
#     net: False
#   - value: ['High', 'TopRight', '5']
#     title: 'High Meas Noise'
#     net: False
#   - value: ['LowProcNoise', 'TopRight', '5']
#     title: 'Meas + Process Noise'
#     title_right: '$N_{traj} = 5$, Top Right'
#     net: False
  
#   - value: ['Low', 'FullSpace', '10']
#     net: False
#   - value: ['High', 'FullSpace', '10']
#     net: False
#   - value: ['LowProcNoise', 'FullSpace', '10']
#     title_right: '$N_{traj} = 10$, Full Space'
#     net: False

# save_config:
#   fname: 'density_nesde_dataset.png'
#   dpi: 500

# plot_configs:
#   - value: ['Low', 'TopRight', '5']
#     title: 'Low Meas Noise'
#     net: True
#   - value: ['High', 'TopRight', '5']
#     title: 'High Meas Noise'
#     net: True
#   - value: ['LowProcNoise', 'TopRight', '5']
#     title: 'Meas + Process Noise'
#     title_right: '$N_{traj} = 5$, Top Right'
#     net: True
  
#   - value: ['Low', 'FullSpace', '10']
#     net: True
#   - value: ['High', 'FullSpace', '10']
#     net: True
#   - value: ['LowProcNoise', 'FullSpace', '10']
#     title_right: '$N_{traj} = 10$, Full Space'
#     net: True

# save_config:
#   fname: 'density_nesde_dataset_nosig.png'
#   dpi: 500


# ############################ Uncertainty mesh plots #################################
# #####################################################################################

# Format for learned models to plot XX__MSD_XX_XX_XX
# For example nestde__MSD_MeasLow_TopRight_5 according to the name of the learned models
files2plot: 'XX__MSD_MeasHigh_TopRight_5'
# max_error: 0.2 # The maximum error to plot on the cbar
gaussian_propagation_method: fixed_model
device: cpu
max_error: 0.1

# The list of models to plot in the configuration (usually a grid) they need to be plotted
fig_args:
  # Number of rows is automatically 2 for these uncertainty plots
  figsize: [14, 8]
  ncols: 3
  sharex: True
  sharey: True
  constrained_layout: True


plot_configs:
  # - value: ['nesde','MeasLow','TopRight','5']
  #   title: 'Low Meas Noise'
  - value: ['node_bboxes',]
    title: 'Neural ODE'
  - value: ['gaussian_mlp_ensemble_hid_32_ens_5',]
    title: 'Probabilistic Ensemble'
    mean_type: median
  - value: ['nesde_bboxes',]
    title: 'Neural SDE'

# save_config:
#   fname: 'Uncertainty_MSD_MeasLow_TopRight_5.png'
#   dpi: 500



############## Plotting trajectories ######################

# # Evaluation dataset
# train_data_name: MSD_MeasHigh_FullSpace_10
# horizon_eval: 800 # Horizon of integration for prediction comparison
# num_particles_eval: 50 # Number of particles for uncertainty
# init_config: [0.15, -0.15]

# # The models to show on the plot
# model2plot: [nesde_bboxes, node_bboxes] # , node_bboxes]
# seed_eval: 15 # The seed for the probabilistic models: sde or jax
# # The percentiles used when plotting the sde distribution
# # alpha_percentiles: [0.05, 0.10, 0.15, 0.20, 0.25, 0.30, 0.35, 0.40, 0.45, 0.50]
# # percentiles_array: [0.999, 0.99, 0.9, 0.8, 0.7, 0.6, 0.5, 0.4, 0.3, 0.25]

# # alpha_percentiles: [0.05, 0.10, 0.15, 0.20, 0.25, 0.30, 0.35, 0.40, 0.45, 0.50]
# # percentiles_array: [0.75, 0.70, 0.65, 0.6, 0.55, 0.53, 0.5, 0.4, 0.3, 0.25]
# alpha_percentiles: [0.05, 0.10, 0.15, 0.20, 0.25, 0.30, 0.35, 0.40, 0.45, 0.50, 0.55]
# percentiles_array: [0.999, 0.99, 0.9, 0.8, 0.7, 0.6, 0.5, 0.4, 0.3, 0.2, 0.1]

# # Which style to use for standardt deviation
# # std_style: perc75 # std or minmax or perc (for percentiles)
# alpha_std: 0.3

# # ylim: 
# #   - null
# #   - null'
#     markersize : 8 
#     alpha : 0.3
#     linestyle : 'None'
#     zorder : 10

# extra_args:
#   legend_args:
#     loc: 'upper center'
#     bbox_to_anchor: [0.5, 1.0]
#     ncol: 4

# # The grid configuration and extra figure parameters like spacing etc..
# fig_args:
#   figsize: [18, 4]

# # ylim:
# #   - [-1.1, 1.1]
# #   - [-1.1, 1.1]
# #   - null

# # Plot general configurations
# general_style:
#   linewidth: 2.0

# # Plot specifc configuration dictionary
# curve_plot_style:
#   nesde:
#     label: "SDE Model"
#     # color: "#ff7f0e"
#     color: "#d62728"
#     color_std: "#d62728"
#     std_style: perc
#     zorder: 60
#   node:
#     label: "Neural ODE"
#     color: "#2ca02c"
#     color_std: "#2ca02c"
#     # std_style: perc
#     linestyle: '--'
#     zorder: 10
#   groundtruth:
#     label: "Groundtruth"
#     color: "#1f77b4"
#     linestyle: '--'
#     zorder: 80
#   dataset:
#     label : 'Dataset'
#     color : 'lavender'
#     marker: 'x
# # save_config:
# #   fname: 'Prediction_PIvsSDE.png'
# #   dpi: 500



#########################################################################################
# # The list of models to plot in the configuration (usually a grid) they need to be plotted
# fig_args:
#   # Number of rows is automatically 2 for these uncertainty plots
#   figsize: [10, 8]
#   ncols: 2
#   sharex: True
#   sharey: True
#   constrained_layout: True


# plot_configs:
#   - value: ['nesde','MeasLow','TopRight','5']
#     title: 'Nesde model'
#   - value: ['node','MeasLow','TopRight','5']
#     title: 'NODE model'
#   #   title: 'Density Neural net'

# save_config:
#   fname: 'uncertainty_nesdeVsnode_lowMeas_topright_5.png'
#   dpi: 500


# plot_configs:
#   - value: ['nesde','MeasLowProcNoise','TopRight','5']
#     title: 'Nesde model'
#   - value: ['node','MeasLowProcNoise','TopRight','5']
#     title: 'NODE model'
#   #   title: 'Density Neural net'

# save_config:
#   fname: 'uncertainty_nesdeVsnode_lowProcMeas_topright_5.png'
#   dpi: 500


# plot_configs:
#   - value: ['nesde','MeasLow','TopRight','5']
#     title: 'Prior model'
#     prior_dist: True
#   - value: ['nesde','MeasLow','TopRight','5']
#     title: 'Nesde model'

# save_config:
#   fname: 'uncertainty_priorVsnesde_lowMeas_topright_5.png'
#   dpi: 500



# ############################ State evolution plots ###################################
# ######################################################################################

# horizon_prediction: 200
# num_particles: 1000

# # The percentiles used when plotting the sde distribution
# alpha_percentiles: [0.05, 0.10, 0.15, 0.20, 0.25, 0.30, 0.35, 0.40, 0.45, 0.50, 0.55]
# percentiles_array: [0.999, 0.99, 0.9, 0.8, 0.7, 0.6, 0.5, 0.4, 0.3, 0.2, 0.1]

# init_config:
#   - [-0.15, -0.15]
#   - [0.05, -0.08]
#   # - [0.1, 0.15]
#   - [0.05, 0.07]

# # Format for learned models to plot XX__MSD_XX_XX_XX
# # For example nestde__MSD_MeasLow_TopRight_5 according to the name of the learned models
# files2plot: 'XX__MSD_MeasLow_TopRight_5'

# # The list of models to plot in the configuration (usually a grid) they need to be plotted
# fig_args:
#   figsize: [14, 10]
#   nrows: 1
#   ncols: 3
#   # sharex: True
#   # sharey: True
#   constrained_layout: True


# plot_configs:
#   - value:
#       - ['gaussian_mlp_ensemble']
#       - ['node']
#       - ['nesde']
#     style: ['gaussian','node', 'nesde']
#     type: "t2q" # q2qdot, 
#     init: 0
#     # show_xlabel: False
  
#   - value:
#       - ['gaussian_mlp_ensemble']      
#       - ['node']
#       - ['nesde']
#     style: ['gaussian','node', 'nesde']
#     type: "t2qdot" # q2qdot, 
#     init: 0
  
#   - value:
#       - ['gaussian_mlp_ensemble']
#       - ['node']
#       - ['nesde']
#     style: ['gaussian','node', 'nesde']
#     type: "q2qdot" # q2qdot, 
#     init: 0

# plot_configs:
#   - value:
#       - ['nesde', 'Low']
#       - ['node', 'Low']
#     style: ['nesde', 'node']
#     type: "t2q" # q2qdot, 
#     init: 0
#     # show_xlabel: False
  
#   - value:
#       - ['nesde', 'Low']
#       - ['node', 'Low']
#     style: ['nesde','node']
#     type: "t2qdot" # q2qdot, 
#     init: 0
  
#   - value:
#       - ['nesde', 'Low']
#       - ['node', 'Low']
#     style: ['nesde', 'node']
#     type: "q2qdot" # q2qdot, 
#     init: 0
#     # show_xlabel: False
  
#   - value:
#       - ['nesde', 'Low']
#       - ['node', 'Low']
#     style: ['nesde','node']
#     type: "t2Err" # q2qdot, 
#     init: 0

# save_config:
#   fname: 'state_nesdeVsnode_MeasLow_TopRight_5_ood.png'
#   dpi: 500


# plot_configs:
#   - value:
#       - ['nesde', 'Low']
#       - ['node', 'Low']
#     style: ['nesde', 'node']
#     type: "t2q" # q2qdot, 
#     init: 1
#     # show_xlabel: False
  
#   - value:
#       - ['nesde', 'Low']
#       - ['node', 'Low']
#     style: ['nesde','node']
#     type: "t2qdot" # q2qdot, 
#     init: 1
  
#   - value:
#       - ['nesde', 'Low']
#       - ['node', 'Low']
#     style: ['nesde', 'node']
#     type: "q2qdot" # q2qdot, 
#     init: 1
#     # show_xlabel: False
  
#   - value:
#       - ['nesde', 'Low']
#       - ['node', 'Low']
#     style: ['nesde','node']
#     type: "t2Err" # q2qdot, 
#     init: 1

# save_config:
#   fname: 'state_nesdeVsnode_MeasLow_TopRight_5_iid.png'
#   dpi: 500


# plot_configs:
#   - value:
#       - ['nesde', 'High']
#       - ['node', 'High']
#     style: ['nesde', 'node']
#     type: "t2q" # q2qdot, 
#     init: 1
#     # show_xlabel: False
  
#   - value:
#       - ['nesde', 'High']
#       - ['node', 'High']
#     style: ['nesde','node']
#     type: "t2qdot" # q2qdot, 
#     init: 1
  
#   - value:
#       - ['nesde', 'High']
#       - ['node', 'High']
#     style: ['nesde', 'node']
#     type: "q2qdot" # q2qdot, 
#     init: 1
#     # show_xlabel: False
  
#   - value:
#       - ['nesde', 'High']
#       - ['node', 'High']
#     style: ['nesde','node']
#     type: "t2Err" # q2qdot, 
#     init: 1

# save_config:
#   fname: 'state_nesdeVsnode_MeasHigh_TopRight_5_iid.png'
#   dpi: 500

# plot_configs:
#   - value:
#       - ['nesde', 'High']
#       - ['node', 'High']
#     style: ['nesde', 'node']
#     type: "t2q" # q2qdot, 
#     init: 0
#     # show_xlabel: False
  
#   - value:
#       - ['nesde', 'High']
#       - ['node', 'High']
#     style: ['nesde','node']
#     type: "t2qdot" # q2qdot, 
#     init: 0
  
#   - value:
#       - ['nesde', 'High']
#       - ['node', 'High']
#     style: ['nesde', 'node']
#     type: "q2qdot" # q2qdot, 
#     init: 0
#     # show_xlabel: False
  
#   - value:
#       - ['nesde', 'High']
#       - ['node', 'High']
#     style: ['nesde','node']
#     type: "t2Err" # q2qdot, 
#     init: 0

# save_config:
#   fname: 'state_nesdeVsnode_MeasHigh_TopRight_5_ood.png'
#   dpi: 500

# plot_configs:
#   - value:
#       - ['nesde', 'LowProcNoise']
#       - ['node', 'LowProcNoise']
#     style: ['nesde', 'node']
#     type: "t2q" # q2qdot, 
#     init: 0
#     # show_xlabel: False
  
#   - value:
#       - ['nesde', 'LowProcNoise']
#       - ['node', 'LowProcNoise']
#     style: ['nesde','node']
#     type: "t2qdot" # q2qdot, 
#     init: 0
  
#   - value:
#       - ['nesde', 'LowProcNoise']
#       - ['node', 'LowProcNoise']
#     style: ['nesde', 'node']
#     type: "q2qdot" # q2qdot, 
#     init: 0
#     # show_xlabel: False
  
#   - value:
#       - ['nesde', 'LowProcNoise']
#       - ['node', 'LowProcNoise']
#     style: ['nesde','node']
#     type: "t2Err" # q2qdot, 
#     init: 0

# save_config:
#   fname: 'state_nesdeVsnode_MeasLowProcNoise_TopRight_5_ood.png'
#   dpi: 500

# plot_configs:
#   - value:
#       - ['nesde', 'LowProcNoise']
#       - ['node', 'LowProcNoise']
#     style: ['nesde', 'node']
#     type: "t2q" # q2qdot, 
#     init: 1
#     # show_xlabel: False
  
#   - value:
#       - ['nesde', 'LowProcNoise']
#       - ['node', 'LowProcNoise']
#     style: ['nesde','node']
#     type: "t2qdot" # q2qdot, 
#     init: 1
  
#   - value:
#       - ['nesde', 'LowProcNoise']
#       - ['node', 'LowProcNoise']
#     style: ['nesde', 'node']
#     type: "q2qdot" # q2qdot, 
#     init: 1
#     # show_xlabel: False
  
#   - value:
#       - ['nesde', 'LowProcNoise']
#       - ['node', 'LowProcNoise']
#     style: ['nesde','node']
#     type: "t2Err" # q2qdot, 
#     init: 1

# save_config:
#   fname: 'state_nesdeVsnode_MeasLowProcNoise_TopRight_5_iid.png'
#   dpi: 500


#################
# files2plot: 'XX__MSD_MeasXX_FullSpace_10'

# plot_configs:
#   - value:
#       - ['nesde', 'LowProcNoise']
#       - ['node', 'LowProcNoise']
#     style: ['nesde', 'node']
#     type: "t2q" # q2qdot, 
#     init: 1
#     # show_xlabel: False
  
#   - value:
#       - ['nesde', 'LowProcNoise']
#       - ['node', 'LowProcNoise']
#     style: ['nesde','node']
#     type: "t2qdot" # q2qdot, 
#     init: 1
  
#   - value:
#       - ['nesde', 'LowProcNoise']
#       - ['node', 'LowProcNoise']
#     style: ['nesde', 'node']
#     type: "q2qdot" # q2qdot, 
#     init: 1
#     # show_xlabel: False
  
#   - value:
#       - ['nesde', 'LowProcNoise']
#       - ['node', 'LowProcNoise']
#     style: ['nesde','node']
#     type: "t2Err" # q2qdot, 
#     init: 1

# save_config:
#   fname: 'state_nesdeVsnode_MeasLowProcNoise_FullSpace_10_iid.png'
#   dpi: 500

# plot_configs:
#   - value:
#       - ['nesde', 'LowProcNoise']
#       - ['node', 'LowProcNoise']
#     style: ['nesde', 'node']
#     type: "t2q" # q2qdot, 
#     init: 0
#     # show_xlabel: False
  
#   - value:
#       - ['nesde', 'LowProcNoise']
#       - ['node', 'LowProcNoise']
#     style: ['nesde','node']
#     type: "t2qdot" # q2qdot, 
#     init: 0
  
#   - value:
#       - ['nesde', 'LowProcNoise']
#       - ['node', 'LowProcNoise']
#     style: ['nesde', 'node']
#     type: "q2qdot" # q2qdot, 
#     init: 0
#     # show_xlabel: False
  
#   - value:
#       - ['nesde', 'LowProcNoise']
#       - ['node', 'LowProcNoise']
#     style: ['nesde','node']
#     type: "t2Err" # q2qdot, 
#     init: 0

# save_config:
#   fname: 'state_nesdeVsnode_MeasLowProcNoise_FullSpace_10_ood.png'
#   dpi: 500

# plot_configs:
#   - value:
#       - ['nesde', 'High']
#       - ['node', 'High']
#     style: ['nesde', 'node']
#     type: "t2q" # q2qdot, 
#     init: 0
#     # show_xlabel: False
  
#   - value:
#       - ['nesde', 'High']
#       - ['node', 'High']
#     style: ['nesde','node']
#     type: "t2qdot" # q2qdot, 
#     init: 0
  
#   - value:
#       - ['nesde', 'High']
#       - ['node', 'High']
#     style: ['nesde', 'node']
#     type: "q2qdot" # q2qdot, 
#     init: 0
#     # show_xlabel: False
  
#   - value:
#       - ['nesde', 'High']
#       - ['node', 'High']
#     style: ['nesde','node']
#     type: "t2Err" # q2qdot, 
#     init: 0

# save_config:
#   fname: 'state_nesdeVsnode_MeasHigh_FullSpace_10_ood.png'
#   dpi: 500

# plot_configs:
#   - value:
#       - ['nesde', 'High']
#       - ['node', 'High']
#     style: ['nesde', 'node']
#     type: "t2q" # q2qdot, 
#     init: 2
#     # show_xlabel: False
  
#   - value:
#       - ['nesde', 'High']
#       - ['node', 'High']
#     style: ['nesde','node']
#     type: "t2qdot" # q2qdot, 
#     init: 2
  
#   - value:
#       - ['nesde', 'High']
#       - ['node', 'High']
#     style: ['nesde', 'node']
#     type: "q2qdot" # q2qdot, 
#     init: 2
#     # show_xlabel: False
  
#   - value:
#       - ['nesde', 'High']
#       - ['node', 'High']
#     style: ['nesde','node']
#     type: "t2Err" # q2qdot, 
#     init: 2

# save_config:
#   fname: 'state_nesdeVsnode_MeasHigh_FullSpace_10_iid.png'
#   dpi: 500